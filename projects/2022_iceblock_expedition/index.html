<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>What if the ice block expedition 1959 happens in 2021? | Zhihao LIU</title> <meta name="author" content="Zhihao LIU"/> <meta name="description" content="You cannot blame it to climate change"/> <meta name="keywords" content="geoscience, geospatial data science, geomorphology, seismic, energy transition, marathon"/> <meta property="og:site_name" content="Zhihao LIU"/> <meta property="og:type" content="website"/> <meta property="og:title" content="Zhihao LIU | What if the ice block expedition 1959 happens in 2021?"/> <meta property="og:url" content="https://zhihaol.eu.org/projects/2022_iceblock_expedition/"/> <meta property="og:description" content="You cannot blame it to climate change"/> <meta property="og:locale" content="en"/> <meta name="twitter:card" content="summary"/> <meta name="twitter:title" content="What if the ice block expedition 1959 happens in 2021?"/> <meta name="twitter:description" content="You cannot blame it to climate change"/> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìì</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://zhihaol.eu.org/projects/2022_iceblock_expedition/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Zhihao&nbsp;</span>LIU</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">What if the ice block expedition 1959 happens in 2021?</h1> <p class="post-description">You cannot blame it to climate change</p> </header> <article> <p>A million tons of ice was shipped from Norway each year during the golden age of ice trade to England, India, South America, China and Australia. The business that involved transporting natural ice for commercial purposes stated at 1806, flourished in the end of 19th-century and was replaced by plant ice until World War I (‚ÄúIce Trade,‚Äù 2022). A primary concern of the ice transportation is the melt loss.</p> <p>Luckily, there is a record to follow. In 1959, a three-ton block of ice from Mo i Rana by the Arctic Circle was trucked to Libreville by the Equator in an advertisement of insulation materials. The event left enough details and measurements: 2714 Kg ice remained with only 11% mass loss(‚ÄúIce Block Expedition of 1959,‚Äù 2022) in a 37 days long journey.</p> <p>Using the EAR5 climate reanalysis dataset (Mu√±oz Sabater, 2021), this study is able to simulate the 1959 ice block expedition by surface energy balance equations and heat transfer equations, which is a new perspective on this event and the topic of ice trade.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/post/ICEBLOCK/figure1_illustration-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/post/ICEBLOCK/figure1_illustration-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/post/ICEBLOCK/figure1_illustration-1400.webp"/> <img src="/assets/img/post/ICEBLOCK/figure1_illustration.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="The ice block expedition 1959" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> The concept of ice deterioration modeling. </div> <h4 id="solutions">Solutions</h4> <ul> <li>The physics basis: <ul> <li>Surface energy balance</li> <li>Heat equation</li> <li>Wind log profile</li> <li>Total heat resistance</li> </ul> </li> <li>Dataset: <ul> <li><a href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-land?tab=overview">ERA5-Land hourly data from 1950 to present (copernicus.eu)</a></li> </ul> </li> <li>The requirements: <ul> <li>numpy, pandas</li> <li>[process kml] geopandas, shapely</li> <li>[heat equations] numba, scipy</li> </ul> </li> </ul> <p>Please find the solutions from <a href="https://github.com/liuh886/the_ice_block_expedition_1959">liuh886/the_ice_block_expedition_1959: Simulate the ice block expedition1959 by energy balance equations and heat equations (github.com)</a> .</p> <h4 id="weather---1959-vs-2021">Weather - 1959 vs 2021</h4> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/post/ICEBLOCK/weatherplot_1959-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/post/ICEBLOCK/weatherplot_1959-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/post/ICEBLOCK/weatherplot_1959-1400.webp"/> <img src="/assets/img/post/ICEBLOCK/weatherplot_1959.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="weatherplot_1959" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> The average skin temperature is 292.2 K, slightly higher than air temperature (291.6 K). Skin temperature could be over 325 K, which is 15 K more than air temperature under the solar radiation of Sahara, but lower than air temperature at night.. </div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/post/ICEBLOCK/weatherplot_2021-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/post/ICEBLOCK/weatherplot_2021-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/post/ICEBLOCK/weatherplot_2021-1400.webp"/> <img src="/assets/img/post/ICEBLOCK/weatherplot_2021.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="weatherplot_2021" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> The air temperature of 2021 is 0.3 K higher than 1959, the relative windspeed of 2021 (4.3 m/s) is heavier than 1959 (3.9 m/s).There was an unusual rainy day in Sahara on 12th Mar. 2021, which increased humidity (or dew temperature) and reduced the solar radiation on that day. </div> <h4 id="scenario---bare-ice">Scenario - Bare ice</h4> <p>What if the expedition went with an ice block without any protection?</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/post/ICEBLOCK/bare_ice-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/post/ICEBLOCK/bare_ice-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/post/ICEBLOCK/bare_ice-1400.webp"/> <img src="/assets/img/post/ICEBLOCK/bare_ice.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="bare_ice" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> The simulations show that 5.59 m of ice melted in the scenario of 1959, and 6.50 m in 2021. The Solar radiation contributed more melt energy (18.5%) in 1959. Latent heat flux and longwave radiation contributed more in 2021, which are 20.4% to 15.5%, 3.1% to 1.0%, compared with 1959. Furthermore, the ice block (1.49√ó1.49 m) would have melted away on 8th Mar. 1959 or 6th Mar. 2021, if ice block expedition was carried out under the scenarios. </div> <h4 id="scenario---1959-2021-and-the-original-records">Scenario - 1959, 2021 and the original records</h4> <p>In original records, only four liters of water had been shed when the truck arrived in Algiers on 3th March 1959. When crossing the Sahara, on average 15 liters melted each day. Finally, only 336 kg ice lost in end of expedition, which is 11.0% of the total mass.</p> <p>In the simulations, Figure below displays that ice mass loss of 352.3 Kg and 348.2 Kg in 1959 and 2021, with 322.8 Kg in 2020 as a reference, which is opposite to the scenario of bare ice. In ice without cover scenario, the bare ice in 2021 melt more than 1959 due to higher air temperature, and more contributions from latent heat and longwave radiation. However, if there is a cover upon ice, the melt mechanism would be different, because the cover does not have phase change. Thus, the longwave radiation and sensible heat actually are going to be cooling component not the melt energy component when it is warmer than air temperature. If water is available, the evaporation would take heat away as well.</p> <p>Table shows that, in the scenario of aluminum_glasswool_1959, the mass loss is 26.5 Kg until Algiers, 14.3 Kg per day in desert, 352.3 Kg in the final destination, which are slightly different with the original records.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/post/ICEBLOCK/1959vs2021_b-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/post/ICEBLOCK/1959vs2021_b-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/post/ICEBLOCK/1959vs2021_b-1400.webp"/> <img src="/assets/img/post/ICEBLOCK/1959vs2021_b.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="1959vs2021_b" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> Melt simulation of total mass loss 1959, 2021 and 2020. </div> <p><strong>Table. The scenario - 1959, 2021 and the original records</strong></p> <table> <thead> <tr> <th>Event</th> <th>Initial Mass [Kg]</th> <th>Insulation</th> <th>Insulation thickness[m]</th> <th>Mass lost Algiers [Kg]</th> <th>Mass loss Sahara [Kg/day]</th> <th>Mass loss In total [Kg]</th> </tr> </thead> <tbody> <tr> <td>Original records</td> <td>3050</td> <td>Mainly glass wool</td> <td>-</td> <td>About 4</td> <td>About 15</td> <td>336</td> </tr> <tr> <td>Aluminum_glasswool_1959</td> <td>3050</td> <td>Glass wool</td> <td>0.25</td> <td>26.5</td> <td>14.3</td> <td>352.3</td> </tr> <tr> <td>Aluminum_glasswool_2021</td> <td>3050</td> <td>Glass wool</td> <td>0.25</td> <td>32.0</td> <td>13.2</td> <td>348.2</td> </tr> <tr> <td>Aluminum_glasswool_2020</td> <td>3050</td> <td>Glass wool</td> <td>0.25</td> <td>23.0</td> <td>11.7</td> <td>322.8</td> </tr> </tbody> </table> <h4 id="heat-equation-model">Heat equation model</h4> <p>The surface energy balance model can only give the amount of heat transfer, which is assumed to be melt energy. But the real changes within the box are still unknow, e.g. (1) What is the temperature distribution of the ice block, or how does the temperature of the ice core fluctuate? (2) How long does it take for ice to melt after warming up to 0 degree Celsius.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/post/ICEBLOCK/heatequation1-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/post/ICEBLOCK/heatequation1-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/post/ICEBLOCK/heatequation1-1400.webp"/> <img src="/assets/img/post/ICEBLOCK/heatequation1.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="heatequation1" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> Figure shows that the warming up of ice core from -6¬∞ to 0¬∞ takes about 175 hours by heat diffusivity. The 1g of ice takes 334 joules to melt into water, which means the ice need storage the energy that equivalent to warm it 0¬∞ to 158.4¬∞. </div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/post/ICEBLOCK/heatequation2-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/post/ICEBLOCK/heatequation2-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/post/ICEBLOCK/heatequation2-1400.webp"/> <img src="/assets/img/post/ICEBLOCK/heatequation2.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="heatequation2" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> Figure zooms in on a corner of the cubic ice. The first 1 cm layer takes less 100 hours to reach 0¬∞, melts by 400 hours. And for the next every 100 hours, 1cm layer disappears. </div> <p>The first layer is equal to 122.1 Kg, the second is 118.9 Kg. The third layer is 115.7 Kg, but it does not go completely. The remain storage energy in temperature is 10.8 K. So, a rough estimation is the (1-10/158.4) *115.7 = 107.8 Kg. Then, the accumulative mass loss is 348.8 Kg.</p> <h4 id="key-codes">Key codes</h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">q_latent</span><span class="p">(</span><span class="n">air_pressure</span><span class="p">,</span><span class="n">air_temp_K</span><span class="p">,</span><span class="n">wind_2</span><span class="p">,</span><span class="n">es</span><span class="p">,</span><span class="n">ea</span><span class="p">):</span> <span class="c1"># downward positive
</span>
    <span class="c1"># calculate latent heat # ASSUME: water is always available! satuation = 1
</span>    <span class="c1"># input:
</span>    <span class="c1"># - es, ea, air_pressure  in Pa
</span>    <span class="c1"># - air_temp_K in K
</span>    <span class="c1"># - wind_2 in m/s
</span>    <span class="c1"># output:
</span>    <span class="c1"># - q_lat in W/m-2
</span>    
    <span class="n">rho_air</span> <span class="o">=</span> <span class="n">air_pressure</span><span class="o">/</span><span class="p">(</span><span class="mf">287.058</span><span class="o">*</span><span class="n">air_temp_K</span><span class="p">)</span>  <span class="c1"># air density [kg /m^3], T in K
</span>    <span class="n">lv</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2500.8</span><span class="o">-</span><span class="mf">2.36</span><span class="o">*</span><span class="p">(</span><span class="n">air_temp_K</span><span class="o">-</span><span class="mf">273.15</span><span class="p">))</span><span class="o">*</span><span class="mi">1000</span><span class="p">;</span> <span class="c1">#latent heat of evaporation of water [J/kg], T in C
</span>    <span class="n">A</span> <span class="o">=</span> <span class="mf">0.4</span><span class="o">*</span><span class="mf">0.4</span> <span class="o">/</span> <span class="n">np</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mf">1e-2</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mf">1e-2</span><span class="p">)</span> <span class="c1"># k = 0.4
</span>    
    <span class="n">q_lat</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.622</span><span class="o">*</span><span class="n">rho_air</span><span class="o">*</span><span class="n">lv</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="n">wind_2</span><span class="o">*</span><span class="p">(</span><span class="n">es</span><span class="o">-</span><span class="n">ea</span><span class="p">)</span><span class="o">/</span><span class="n">air_pressure</span><span class="p">;</span> <span class="c1"># potential evaporation ASSUME: water is available
</span>
    <span class="k">return</span> <span class="n">q_lat</span>
    
<span class="k">def</span> <span class="nf">q_sensi</span><span class="p">(</span><span class="n">air_pressure</span><span class="p">,</span><span class="n">air_temp_K</span><span class="p">,</span><span class="n">wind_2</span><span class="p">,</span><span class="n">ta</span><span class="p">,</span><span class="n">ts</span><span class="p">):</span> <span class="c1"># downward positive
</span>    <span class="c1"># calculate sensible heat 
</span>    <span class="c1"># input:
</span>    <span class="c1"># - ta, ts in same unit, K or T
</span>    <span class="c1"># - air_temp_K in K
</span>    <span class="c1"># - wind_2 in m/s
</span>    <span class="c1"># output:
</span>    <span class="c1"># - q_sen in W/m-2
</span>    <span class="n">cp_air</span> <span class="o">=</span> <span class="mi">1005</span>  <span class="c1"># heat capacity of air   J/(kg*K)
</span>
    <span class="n">rho_air</span> <span class="o">=</span> <span class="n">air_pressure</span><span class="o">/</span><span class="p">(</span><span class="mf">287.058</span><span class="o">*</span><span class="n">air_temp_K</span><span class="p">)</span>  <span class="c1"># air density [kg /m^3], T in K
</span>    <span class="n">lv</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2500.8</span><span class="o">-</span><span class="mf">2.36</span><span class="o">*</span><span class="p">(</span><span class="n">air_temp_K</span><span class="o">-</span><span class="mf">273.15</span><span class="p">))</span><span class="o">*</span><span class="mi">1000</span><span class="p">;</span> <span class="c1">#latent heat of evaporation of water [J/kg], T in C
</span>    <span class="n">A</span> <span class="o">=</span> <span class="mf">0.4</span><span class="o">*</span><span class="mf">0.4</span> <span class="o">/</span> <span class="n">np</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mf">1e-2</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mf">1e-2</span><span class="p">)</span> <span class="c1"># k = 0.4
</span>    
    <span class="n">q_sen</span> <span class="o">=</span> <span class="n">cp_air</span><span class="o">*</span><span class="n">rho_air</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="n">wind_2</span><span class="o">*</span><span class="p">(</span><span class="n">ta</span><span class="o">-</span><span class="n">ts</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">q_sen</span>    

<span class="c1">## 2d heat equation
</span>
<span class="kn">import</span> <span class="n">copy</span>
<span class="kn">from</span> <span class="n">numba</span> <span class="kn">import</span> <span class="n">jit</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="n">scipy.ndimage</span> <span class="kn">import</span> <span class="n">binary_dilation</span><span class="p">,</span> <span class="n">binary_erosion</span>

<span class="c1"># 1 environment
</span><span class="n">box_t</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">loadtxt</span><span class="p">(</span><span class="sh">'</span><span class="s">1959_box_temp.csv</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># 2 settings
</span><span class="n">a_ice</span> <span class="o">=</span> <span class="mf">1.19e-6</span> <span class="c1"># heat difussivity [m2/s]
</span><span class="n">a_air</span> <span class="o">=</span> <span class="mf">18.46e-6</span> <span class="c1"># heat difussivity [m2/s]
</span><span class="n">a_gw</span> <span class="o">=</span> <span class="mf">1.785e-6</span> <span class="c1"># heat difussivity [m2/s]
</span>
<span class="n">lf</span> <span class="o">=</span> <span class="mi">334000</span> <span class="c1">#Latent heat of fusion L f = 334 000 J/kg -1 (phase change ice ‚Äì water)
</span><span class="n">cp_ice</span> <span class="o">=</span> <span class="mi">2108</span> <span class="c1"># J/(kgK)
</span><span class="n">rho_ice</span> <span class="o">=</span> <span class="mi">917</span> <span class="c1"># Kg/m3
</span>
<span class="n">t_ice</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span> <span class="c1"># initial temperature of ice
</span><span class="n">dx</span><span class="o">=</span><span class="mf">0.01</span> <span class="c1"># 1cm nodes
</span><span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># seconds
</span><span class="n">hours</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">box_t</span><span class="p">)</span> <span class="c1"># hours here is 796
# 3 initial 
</span><span class="n">heatmap</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">([</span><span class="n">ice_width</span><span class="p">,</span><span class="n">ice_width</span><span class="p">])</span><span class="o">+</span><span class="n">t_ice</span> <span class="c1"># inital temp
</span><span class="n">block</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">ones</span><span class="p">([</span><span class="n">ice_width</span><span class="p">,</span><span class="n">ice_width</span><span class="p">])</span>   <span class="c1"># initial musk   1:ice 0:air
</span><span class="n">tt</span> <span class="o">=</span> <span class="n">lf</span><span class="o">*</span><span class="n">rho_ice</span><span class="o">*</span><span class="mf">0.01</span><span class="o">*</span><span class="mf">0.01</span><span class="o">*</span><span class="mf">0.01</span><span class="o">/</span><span class="p">(</span><span class="n">cp_ice</span><span class="o">*</span><span class="n">rho_ice</span><span class="o">*</span><span class="mf">0.01</span><span class="o">*</span><span class="mf">0.01</span><span class="o">*</span><span class="mf">0.01</span><span class="p">)</span><span class="o">-</span><span class="n">t_ice</span>  <span class="c1"># energy musk: the energy required to melt in [K]
</span><span class="n">energy</span> <span class="o">=</span> <span class="n">block</span><span class="o">*</span><span class="n">tt</span>

<span class="n">block</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],:]</span><span class="o">=</span><span class="mi">0</span> <span class="c1"># air boundary
</span><span class="n">block</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">=</span><span class="mi">0</span>

<span class="n">energy</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],:]</span><span class="o">=</span><span class="mi">0</span> <span class="c1"># air boundary
</span><span class="n">energy</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">=</span><span class="mi">0</span>

<span class="nd">@jit</span><span class="p">(</span><span class="n">nopython</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nogil</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">iteration</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span><span class="n">inner_musk</span><span class="p">,</span><span class="n">energy</span><span class="p">,</span><span class="n">outer_musk</span><span class="p">,</span><span class="n">box_t</span><span class="p">):</span>
    <span class="n">ns</span> <span class="o">=</span> <span class="n">cs</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span> <span class="c1"># new state
</span>    <span class="n">ns_energy</span> <span class="o">=</span> <span class="n">energy</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span> <span class="c1"># new state
</span>    <span class="n">ly</span><span class="p">,</span><span class="n">lx</span> <span class="o">=</span> <span class="n">ns</span><span class="p">.</span><span class="n">shape</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">lx</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ly</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">outer_musk</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1">#outer node
</span>                <span class="c1">#heat flux -&gt; warm-up 
</span>                <span class="c1">#q = (box_t-cs[j][i])/0.25*0.04   # W/m2
</span>                <span class="c1">#dT = q/(917*0.01)/2108
</span>                <span class="n">ns</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span>  <span class="p">(</span><span class="n">box_t</span><span class="o">-</span><span class="n">cs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mf">0.25</span><span class="o">*</span><span class="mf">0.04</span><span class="o">/</span><span class="p">(</span><span class="mi">917</span><span class="o">*</span><span class="mf">0.01</span><span class="p">)</span><span class="o">/</span><span class="mi">2108</span><span class="o">*</span><span class="n">dt</span>
                <span class="n">ns_energy</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">energy</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">box_t</span><span class="o">-</span><span class="n">cs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mf">0.25</span><span class="o">*</span><span class="mf">0.04</span><span class="o">/</span><span class="p">(</span><span class="mi">917</span><span class="o">*</span><span class="mf">0.01</span><span class="p">)</span><span class="o">/</span><span class="mi">2108</span><span class="o">*</span><span class="n">dt</span>
                <span class="c1">#ns_energy[j][i] = energy[j][i] - 30/3600*dt
</span>
                <span class="c1"># -&gt;add energy storage -&gt; latent heat flux
</span>                <span class="k">if</span> <span class="n">ns</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">ns</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">if</span> <span class="n">inner_musk</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1">#inner node
</span>                <span class="n">ns</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">a_ice</span><span class="o">*</span><span class="n">dt</span><span class="o">/</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">cs</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">cs</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span>
                                                        <span class="n">cs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">cs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span>
                                                        <span class="mi">4</span><span class="o">*</span><span class="n">cs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1">#pass boundry conditon
</span>                <span class="k">pass</span>
    <span class="k">return</span> <span class="n">ns</span><span class="p">,</span><span class="n">ns_energy</span>
<span class="k">def</span> <span class="nf">find_outer_musk</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">a</span><span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="nf">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span> <span class="c1"># for 4-connected
</span>    <span class="c1">#k = np.zeros((3,3),dtype=int); k[1] = 1; k[:,1] = 1 # for 8-connected
</span>    <span class="n">out</span> <span class="o">=</span> <span class="nf">binary_dilation</span><span class="p">(</span><span class="n">a</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">a</span>
    <span class="n">inside</span> <span class="o">=</span> <span class="nf">binary_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">).</span><span class="nf">astype</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span><span class="p">,</span><span class="n">inside</span>

<span class="k">def</span> <span class="nf">solve_heat</span><span class="p">(</span><span class="n">heatmap</span><span class="p">,</span><span class="n">block</span><span class="p">,</span><span class="n">box_temp_list</span><span class="p">,</span><span class="n">energy</span><span class="p">):</span>
    <span class="n">hm_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">block_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">energy_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">inner_musk_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="n">heatmap</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span> <span class="c1"># initial temp state
</span>    <span class="n">energy_musk</span> <span class="o">=</span> <span class="n">energy</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
    <span class="n">block_musk</span> <span class="o">=</span> <span class="n">block</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">hours</span><span class="p">):</span>     
        
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3600</span><span class="p">):</span> <span class="c1"># iteration in seconds
</span>            <span class="c1"># HEAT diffusion
</span>            <span class="n">outer_musk</span><span class="p">,</span><span class="n">inner_musk</span> <span class="o">=</span> <span class="nf">find_outer_musk</span><span class="p">(</span><span class="n">block_musk</span><span class="p">)</span>
            <span class="n">cs</span><span class="p">,</span><span class="n">energy_musk</span> <span class="o">=</span> <span class="nf">iteration</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span><span class="n">inner_musk</span><span class="p">,</span><span class="n">energy_musk</span><span class="p">,</span><span class="n">outer_musk</span><span class="p">,</span><span class="n">box_temp_list</span><span class="p">[</span><span class="n">h</span><span class="p">])</span> <span class="c1">#update cs and energy_musk
</span>            <span class="n">block_musk</span><span class="p">[</span><span class="n">energy_musk</span> <span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># update blockmusk: TURN INTO AIR
</span>        <span class="k">if</span> <span class="n">h</span><span class="o">%</span><span class="mi">1</span> <span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="c1"># return every hour
</span>            <span class="n">hm_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
            <span class="n">block_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">block_musk</span><span class="p">.</span><span class="nf">copy</span><span class="p">())</span>
            <span class="n">energy_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">energy_musk</span><span class="p">)</span>
            <span class="n">inner_musk_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">inner_musk</span><span class="p">)</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Now: in hour</span><span class="sh">'</span><span class="p">,</span><span class="nf">len</span><span class="p">(</span><span class="n">hm_list</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">hm_list</span><span class="p">,</span><span class="n">block_list</span><span class="p">,</span><span class="n">energy_list</span><span class="p">,</span><span class="n">inner_musk_list</span>

<span class="c1">### Main
</span>
<span class="n">hm_list_2d</span><span class="p">,</span><span class="n">block_2d</span><span class="p">,</span><span class="n">energy_2d</span><span class="p">,</span><span class="n">inner_musk_2d</span> <span class="o">=</span> <span class="nf">solve_heat</span><span class="p">(</span><span class="n">heatmap</span><span class="p">,</span><span class="n">block</span><span class="p">,</span><span class="n">box_t</span><span class="p">,</span><span class="n">energy</span><span class="p">)</span>
</code></pre></div></div> <h4 id="few-thoughts">Few thoughts</h4> <p>1D Surface energy balance equations are used on the control surface. And the heat equations can be applied to 2D or 3D homogeneous material.</p> <p>There are some results that are very close the original records. The simulations show that only about 3 cm thick, or 348.8 Kg to 352.3 Kg of the ice block melted. The heat equation simulation revealed temperature distribution of ice inside the box. The ice block takes 175 hours warming up from -6¬∞ to 0¬∞ in the expedition.</p> <p>Transporting ice to the tropics in the 19th century was totally manageable business. Using a white-covered wooden box filled with double thickness is able to achieve the same insulation effect as glass wool, which is fully expected by simulations. We can use the ice block expedition of 1959 as a baseline. If we do an expedition again, the melt loss of transporting ice is not expected over than 1959. And, the simulations do not support blaming it to climate change because there is a covering upon ice.</p> <p>The simulations could also explain <a href="https://www.antarcticglaciers.org/glacier-processes/mass-balance/the-role-of-debris-cover-on-glacier-ablation/">the role of debris cover on glacier ablation</a>.</p> <h4 id="useful-info">Useful info</h4> <p><a href="https://hplgit.github.io/fdm-book/doc/pub/book/sphinx/._book011.html#">Diffusion equations (hplgit.github.io)</a></p> <p><a href="https://www.reddit.com/r/math/comments/mr95j9/solving_3d_heat_equation_in_python_to_cook_a/">Solving 3D Heat Equation in Python to cook a Turkey! See comments for further description of this project : math (reddit.com)</a></p> <p><a href="https://nbviewer.org/github/barbagroup/CFDPython/blob/master/lessons/09_Step_7.ipynb">12 steps to Navier‚ÄìStokes: step7 2D heat diffusion</a></p> </article></div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> &copy; Copyright 2023 Zhihao LIU. Powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>